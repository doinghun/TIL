(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{103:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return p})),a.d(t,"default",(function(){return s}));var n=a(3),l=a(7),r=(a(0),a(132)),b=["components"],i={slug:"aws-ec2-intro",title:"AWS EC2 - Intro",main_category:"DevOps",category:"2. Cloud",status:"\u2705 Completed",last_edited_time:new Date("2021-09-28T00:00:00.000Z")},c={unversionedId:"devops/2-cloud/aws-ec2-intro",id:"devops/2-cloud/aws-ec2-intro",isDocsHomePage:!1,title:"AWS EC2 - Intro",description:"What is EC2",source:"@site/docs/devops/2-cloud/aws-ec2-intro.md",slug:"/devops/2-cloud/aws-ec2-intro",permalink:"/TIL/docs/devops/2-cloud/aws-ec2-intro",editUrl:"https://github.com/doinghun/TIL/edit/master/website/docs/devops/2-cloud/aws-ec2-intro.md",version:"current",lastUpdatedAt:1632925168,sidebar:"devops",previous:{title:"Prettier Setup Troubleshooting",permalink:"/TIL/docs/devops/1-infra/devops-prettier-setup-troubleshooting"},next:{title:"AWS IAM",permalink:"/TIL/docs/devops/2-cloud/aws-iam"}},p=[{value:"What is EC2",id:"what-is-ec2",children:[]},{value:"SSH",id:"ssh",children:[]},{value:"EC2 Instance Types",id:"ec2-instance-types",children:[]},{value:"Network",id:"network",children:[]},{value:"Placement Groups",id:"placement-groups",children:[]},{value:"Advanced",id:"advanced",children:[]}],o={rightToc:p};function s(e){var t=e.components,a=Object(l.a)(e,b);return Object(r.b)("wrapper",Object(n.a)({},o,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h3",{id:"what-is-ec2"},"What is EC2"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Elastic Compute Cloud = Infra as a Service")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Consists of"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"EC2: Renting virtual machines")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"EBS:")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"ELB")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"ASG")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Config options"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"OS")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"CPU")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"RAM")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Storage space")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Network card")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Firewall rules")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Bootstrap script")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"EC2 Instance Types"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"naming convention")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"m5.2xlarge -> m: instance class; 5: generation (version); 2xlarge: size within the instance class")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"General Purpose")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Compute Optimized -> Compute intensive tasks that require high performance processors")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Memory Optimized -> Fast perf for workloads that process large data sets in memoery")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Storage Optimized -> Great for storage-intensive tasks that require high sequential read & write access to large data sets on local storage"),Object(r.b)("br",null))))),Object(r.b)("h4",{id:"security-groups"},"Security Groups"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Fundamental of network security in AWS")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Control how traffic is allowed into / out of EC2 instances")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},'"Firewall" on EC2 instances')),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Regulate"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Access to Ports")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Authorised IP ranges - IPv4 & IPv6")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Control of inbound & outbound network")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Good to maintain one separate security group for SSH access")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"If application is not accessible (Time Out), then it's a security group issue")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Classic Ports to Know"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"22 = SSH (Secure Shell) - log into a Linux instance")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"21 = FTP (File Transfer Protocol) - upload files into a file share")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"22 = SFTP (Secure File Transfer Protocol) - upload files using SSH")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"80 = HTTP - access unsecured websites")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"443 = HTTPS - access secured websites")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"3389 = RDP (Remote Desktop Protocol) - log into a Windows instance"),Object(r.b)("br",null))))),Object(r.b)("h3",{id:"ssh"},"SSH"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Mac/Linux"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"SSH"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Windows"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Putty"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"All"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"EC2 Instance Connect (web)")))),Object(r.b)("p",null,"What is SSH?"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Allows you to control remote machine using a command line")),Object(r.b)("br",null),Object(r.b)("p",null,"How to use?"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-javascript"},"ssh -i EC2Tutorial.pem ec2-user@{PUBLIC_IP_ADDRESS}\n")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Permissions 0644 : required that your private key files are not accessible by others"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"chmod 0400 EC2Tutorial.pem")))),Object(r.b)("br",null),Object(r.b)("h3",{id:"ec2-instance-types"},"EC2 Instance Types"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"On Demand")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Reserved")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Spot Instances")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Dedicated Hosts")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Dedicated Instances"))),Object(r.b)("br",null),Object(r.b)("h3",{id:"network"},"Network"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Elastic IPs"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"If fixed public IP for an instance is needed \u2192 Elastic IP")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"A public IPv4 IP you own")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"5 Elastic IPs per account")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"NOT RECOMMENDED: Poor architectural decisions => Instead use random public IP & register DNS name to it or use Load Balancer & don't use public IP"),Object(r.b)("br",null))))),Object(r.b)("h3",{id:"placement-groups"},"Placement Groups"),Object(r.b)("p",null,"Cluster"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Clusters instances into a low-latency group in a single Availability Zone")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Pros: Great network")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Cons: If the rack fails, all instances fail at the same time")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Use case: Big Data job that needs to complete fast; Application that needs extremely low latency & high network throughput"))),Object(r.b)("p",null,"Spread"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"spreads instances across underlying hardware (max 7 instances per group per AZ) - critical applications")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Pros:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Can span across AZ"),Object(r.b)("li",{parentName:"ul"},"Reduced risk of simultaneous failure"),Object(r.b)("li",{parentName:"ul"},"EC2 Instances on different physical hardware"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Cons:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Limited to 7 instances per AZ per placement group"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Use case:")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Application that needs to maximize high availability")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Critical Applications where each instance must be isolated from failure from each other"))),Object(r.b)("p",null,"Partition"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"spreads instances across many different partitions within AZ. Scales to 100s of EC2 instances per group")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Pros:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Up to 7 partitions per AZ"),Object(r.b)("li",{parentName:"ul"},"Can span across multiple AZs in the same region"),Object(r.b)("li",{parentName:"ul"},"Up to 100s of EC2 instances"),Object(r.b)("li",{parentName:"ul"},"The instances in a partition do not share racks with the instances in the other partitions"),Object(r.b)("li",{parentName:"ul"},"A partition failure can affect many EC2 but won't affect other partitions"),Object(r.b)("li",{parentName:"ul"},"EC2 instances get access to the partition info as metadata"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Use case:"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"HDFS")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"HBase")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Cassandra")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Kafka"),Object(r.b)("br",null))))),Object(r.b)("h4",{id:"elastic-network-interfaces-eni"},"Elastic Network Interfaces (ENI)"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"logical component in a VPC that represents a virtual network card")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Can have following attributes"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Primary private IPv4, on or more secondary IPv4")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"One Elastic IP (IPv4) per private IPv4")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"One Public IPv4")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"One or more security groups")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"a MAC address")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"You can create ENI independently & attach them on the fly on EC2 instances for failover")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Bound to specific AZ"))),Object(r.b)("p",null,"More control over IP"),Object(r.b)("br",null),Object(r.b)("h4",{id:"ec2-hibernate"},"EC2 Hibernate"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Stop: the data on disk (EBS) is kept intact in the next start")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Terminate: any EBS volumes (root) also set-up to be destroyed is lost")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"First start: OS boots & EC2 User Data script is run")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Following starts: OS boots")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Then application starts, caches get warmed up & can take time"))),Object(r.b)("p",null,"\u21d2 Hibernate!"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"All in-memory (RAM) state is preserved")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"instance boot is much faster (OS not stopped or restarted)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Under the hood"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"RAM state is written to a file in the root EBS volume (must be encrypted)"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Use cases"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"long-running processing")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"saving the RAM state")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"services that take time to initialize")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("details",null,Object(r.b)("summary",null,"(Good to know)"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"C, M & R instance families")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Must be less than 150GB RAM size")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"not supported for bare metal instances")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"AMI: Amazon Linux 2, Linux AMI, Ubuntu & Windows")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"RootVolume: must be EBS, encrypted, not instance store & large")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Available for On-Demand & Reserved instances")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Max 60 Days")))))),Object(r.b)("br",null),Object(r.b)("h3",{id:"advanced"},"Advanced"),Object(r.b)("p",null,"EC2 Nitro"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Underlying platform for next gen EC2 instances")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"New virtualization technology")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Better performance"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Better networking options enhanced networking)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Higher speed EBS (64,000 EBS IOPS)")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Better underlying security"))),Object(r.b)("p",null,"vCPU"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Multiple threads can run on one CPU (multithreading)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Each thread is represented as a vCPU")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Optimizing CPU options"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"#. of CPU cores: \u2b07\ufe0f CPU cores \u2192 \u2b07\ufe0f licensing costs (If need high RAM)")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"#. of threads per core: Disable multithreading (If need high Performance Computing workloads)")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Capacity Reservations"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Ensure you have EC2 Capacity when needed")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"Combine with Reserved Instances & Savings Plans to do cost saving"),Object(r.b)("br",null))))))}s.isMDXComponent=!0},132:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return O}));var n=a(0),l=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=l.a.createContext({}),o=function(e){var t=l.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=o(e.components);return l.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},m=l.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,b=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),s=o(a),m=n,O=s["".concat(b,".").concat(m)]||s[m]||u[m]||r;return a?l.a.createElement(O,i(i({ref:t},p),{},{components:a})):l.a.createElement(O,i({ref:t},p))}));function O(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,b=new Array(r);b[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,b[1]=i;for(var p=2;p<r;p++)b[p]=a[p];return l.a.createElement.apply(null,b)}return l.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);